<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Discord íŒŒí‹° ìƒì„±ê¸° í…ŒìŠ¤íŠ¸</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; background-color: #f4f7f6; }
        .container { max-width: 600px; margin: 0 auto; background: #fff; padding: 30px; border-radius: 8px; box-shadow: 0 4px 8px rgba(0,0,0,0.1); }
        h1 { color: #5865f2; text-align: center; margin-bottom: 25px; }
        label { display: block; margin-bottom: 8px; font-weight: bold; color: #23272a; }
        textarea { width: 100%; padding: 10px; margin-bottom: 20px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; resize: vertical; }
        button { background-color: #5865f2; color: white; padding: 12px 20px; border: none; border-radius: 4px; cursor: pointer; width: 100%; font-size: 16px; transition: background-color 0.3s; }
        button:hover { background-color: #4752c4; }
        #response-area { margin-top: 20px; padding: 15px; background-color: #e9e9f7; border-radius: 4px; white-space: pre-wrap; word-wrap: break-word; font-size: 14px; }
        .warning { color: red; margin-bottom: 15px; font-weight: bold; }
    </style>
</head>
<body>

    <div class="container">
        <h1>Discord íŒŒí‹° ì±„ë„ ìƒì„± í…ŒìŠ¤íŠ¸</h1>
        
        <p class="warning">
            âš ï¸ ì´ í˜ì´ì§€ëŠ” í…ŒìŠ¤íŠ¸ìš©ì…ë‹ˆë‹¤. ë°˜ë“œì‹œ ì•„ë˜ JavaScript ì½”ë“œì— **Render Public URL**ì„ ì…ë ¥í•´ì•¼ ì‘ë™í•©ë‹ˆë‹¤.
        </p>

        <label for="memberIdsInput">ì´ˆëŒ€í•  ìœ ì € ID ëª©ë¡ (ì‰¼í‘œ ë˜ëŠ” ì¤„ ë°”ê¿ˆìœ¼ë¡œ êµ¬ë¶„):</label>
        <textarea id="memberIdsInput" rows="5" placeholder="ì˜ˆì‹œ: 123456789012345678, 987654321098765432"></textarea>

        <button onclick="createParty()">íŒŒí‹° ì±„ë„ ìƒì„± ìš”ì²­</button>

        <label for="response-area">ë´‡ ì‘ë‹µ:</label>
        <pre id="response-area">ì—¬ê¸°ì— ë´‡ì˜ ì‘ë‹µì´ í‘œì‹œë©ë‹ˆë‹¤.</pre>
    </div>

    <script>
        // ğŸš¨ ì¤‘ìš”: ì—¬ê¸°ì— ì‹¤ì œ Render URLì„ ì…ë ¥í•´ì•¼ í•©ë‹ˆë‹¤!
        const RENDER_PUBLIC_URL = "https://game-pot.onrender.com"; 
        const ENDPOINT = "/api/create-party";

        async function createParty() {
            // ğŸ¯ ìˆ˜ì • 1: IDê°€ 'memberIdsInput'ì¸ ìš”ì†Œì—ì„œ ê°’ì„ ê°€ì ¸ì˜µë‹ˆë‹¤.
            const idsInput = document.getElementById('memberIdsInput').value; 
            const responseArea = document.getElementById('response-area');
            responseArea.textContent = 'ìš”ì²­ì„ ë³´ë‚´ëŠ” ì¤‘...';

            if (!idsInput.trim()) {
                responseArea.textContent = 'ì´ˆëŒ€í•  ìœ ì € IDë¥¼ ì…ë ¥í•˜ì„¸ìš”.';
                return;
            }
            
            // ğŸ¯ ìˆ˜ì • 2: ìœ ì € ID ëª©ë¡ì„ ë°°ì—´ë¡œ ì •ë¦¬
            const memberIds = idsInput
                .split(/[\s,]+/) 
                .map(id => id.trim())
                .filter(id => id.length > 10 && !isNaN(id)); // ìœ íš¨í•œ IDì¸ì§€ ìµœì¢… í•„í„°ë§

            if (memberIds.length === 0) {
                responseArea.textContent = 'ìœ íš¨í•œ ìœ ì € IDê°€ ì—†ìŠµë‹ˆë‹¤.';
                return;
            }

            try {
                const response = await fetch(`${RENDER_PUBLIC_URL}${ENDPOINT}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        // ğŸ¯ ìˆ˜ì • 3: memberIdsë¼ëŠ” ì´ë¦„ìœ¼ë¡œ ì „ì†¡
                        memberIds: memberIds 
                    })
                });

                const data = await response.json();

                if (response.ok) {
                    // ğŸ¯ ìˆ˜ì • 4: 'ì°¾ì„ ìˆ˜ ì—†ëŠ” ë‹‰ë„¤ì„' ëŒ€ì‹  'ì°¾ì„ ìˆ˜ ì—†ëŠ” ID'ë¡œ ìˆ˜ì •
                    responseArea.textContent = `âœ… ì„±ê³µ!\në©”ì‹œì§€: ${data.message}\nì´ˆëŒ€ ë§í¬: ${data.inviteLink || 'N/A'}\nì°¾ì„ ìˆ˜ ì—†ëŠ” ID: ${data.notFoundIds.join(', ') || 'ì—†ìŒ'}`;
                } else {
                    responseArea.textContent = `âŒ ì˜¤ë¥˜ ë°œìƒ (${response.status} ${response.statusText})\në©”ì‹œì§€: ${data.error || 'Internal Error'}`;
                }

            } catch (error) {
                responseArea.textContent = `âŒ ë„¤íŠ¸ì›Œí¬ ìš”ì²­ ì‹¤íŒ¨: Render URLì´ ì •í™•í•œì§€, ë´‡ì´ ì¼œì ¸ ìˆëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”.`;
                console.error('Fetch error:', error);
            }
        }
    </script>

</body>
</html>